generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = "postgresql://neondb_owner:npg_aos4M2HiCKAS@ep-shiny-star-ahumjr3u-pooler.c-3.us-east-1.aws.neon.tech/neondb?sslmode=require&channel_binding=require"
}

model User {
  id       String  @id @default(uuid())
  email    String  @unique
  password String?
  name     String?
  photo    String?
  googleId String? @unique // ðŸ‘ˆ Add this new field

  chats       Chat[]
  rooms       Room[] @relation("AdminRooms") // Rooms created/owned by this user
  collabRooms Room[] @relation("CollabRooms") // Rooms where this user is a guest
}

model Room {
  id        Int      @id @default(autoincrement())
  slug      String   @unique
  createdAt DateTime @default(now())

  // The Admin (Owner) of the room
  adminId String
  admin   User   @relation("AdminRooms", fields: [adminId], references: [id])

  // The Collaborators (Guests) - Many-to-Many relationship
  collaborators User[] @relation("CollabRooms")

  chats Chat[]
}

model Chat {
  id      Int    @id @default(autoincrement())
  roomId  Int
  message String
  userId  String

  room Room @relation(fields: [roomId], references: [id])
  user User @relation(fields: [userId], references: [id])
}
